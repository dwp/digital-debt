{% import "macros/elements_forms.html" as elements_forms %}

{% extends "layouts/layout.html" %}

{% block page_title %}
  {{ (page.title + ' &ndash; ') | safe if page.title }}{{ serviceName }}
{% endblock %}

{% block body_classes %}{% if page.body_classes %}{% for class in page.body_classes %}{{ class }}{% if not loop.last and loop.length > 1 %} {% endif %}{% endfor %}{% endif %} {{ prototype.current.body_class }}{% endblock %}



{% block content %}
<script type="text/javascript">
var cookieName  ='debt-ammount';

  function getCookie(cname) {
    var name = cname + "=";
    var ca = document.cookie.split(';');
    for(var i = 0; i < ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0) == ' ') {
            c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
            return c.substring(name.length, c.length);
        }
    }
    return "";
}

</script>
  <main id="content"{{ (' class="' + page.contentClasses + '"') | safe if page.contentClasses }}>  
     {% include "includes/phase_banner_alpha.html" %}  
    {% block main %}
      {% block prepend_main %}{% endblock %}
      <div class="grid-row">
        
        {% block __primary__ %}
          <div class="column-{{ page.primary.col | d('two-thirds') }}">
            {% block primary %}{% endblock %}
          </div>
        {% endblock %}
        
        {% block __secondary__ %}
          {% if page.secondary %}
          <div class="column-{{ page.secondary.col | d('one-third') }}">
            {% block secondary %}  
            {% endblock %}
          </div>
          {% endif %}
        {% endblock %}
      
      </div>
      {% block append_main %}{% endblock %}
    {% endblock %}
  </main>
{% endblock %}

{% block body_end %}
  {{ super() }}
  {% if page.dev %}
    {{ (serviceName + " context data: ") | log(true) }}
    {{ __locals__ | log }}
  {% endif %}

  <script>
////////////////////////////////////////////

  $(document).ready(function () {
      $('span').each(function () {
        if ($(this).attr('data-start')) {
          $(this).html($(this).attr('data-start'));
        }
      });
  });

    $(document).on('keyup', '#text-area', function () {
      var span = $(this).parents('.form-group').find('.form-hint span');
      var start = $(this).parents('.form-group').find('.form-hint span').attr('data-start');
      remaning = start - $(this).val().length;
      span.html(remaning);
    });

///////////////////////////////


    $(document).on('keyup', '#value-adjust-1', function () {
      var that = $(this)[0];
      if(that.value > minRepaymentAmmount){

          var months = Math.ceil(totalDebt / that.value)
          var endDate = new Date();
          endDate.setMonth(endDate.getMonth() + months);
          
          $('#payed-by').css('font-weight','bold');
          $('#payed-by').html("1 " + endDate.toLocaleString(locale, { month: "long" }) + " " + endDate.getUTCFullYear());
          $('#paid-off').addClass('date-change');
      } else 
      {
        $('#paid-off').removeClass('date-change');
      }
    });

    $(document).on('click', '#submitButton-rv', function () {
      var that = $('#value-adjust-1')[0];
      if(that.value < minRepaymentAmmount){
        $('#paid-off').removeClass('date-change');
        $('#reduce-error').addClass('border-error');
        return false;
      }
    });
    
///////////////////////////////////



$(document).on('click','#Start-Submit',function(){
var ammount = $('#Debt-Start')[0].value;
setCookie(cookieName,ammount, 30);

//alert(getCookie(cookieName))
//return false;
});

function setCookie(cname, cvalue, exdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays*24*60*60*1000));
    var expires = "expires="+d.toUTCString();
    document.cookie = cname + "=" + cvalue + "; " + expires;
}



function checkCookie() {
    var user = getCookie("username");
    if (user != "") {
        alert("Welcome again " + user);
    } else {
        user = prompt("Please enter your name:", "");
        if (user != "" && user != null) {
            setCookie("username", user, 365);
        }
    }
}

</script>
{% endblock %}